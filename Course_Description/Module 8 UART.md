# UART (通用非同步收發器) 

## UART 是什麼？

- UART 是一種將平行資料轉為序列資料傳送的電路。
- 通常與序列 I/O 埠 (如 RS-232、USB-C) 搭配使用。
- 在 FPGA 板上只需設計 UART 電路，板子會處理 USB 協定。
- UART 包含兩部分：
  - **Transmitter（發射器）**
  - **Receiver（接收器）**

**類比說明**：
- 在傳輸端，UART 把「平行資料（例如一個 8-bit 的字元）」轉換成「一條序列線上的一連串位元」。
  - ➜ 就像是把字變成一長串點字的摩斯密碼，然後一位一位送出去。
- 在接收端，UART 從這條線上一位一位地接收位元，然後重新組合還原成原本的「一個字（Byte 或 char）」。


## UART 發射器 (Transmitter)

- 為一個移位暫存器（shift register）。
- **傳輸格式**：
  1. 起始位元（start bit）：固定為 0。
  2. 資料位元：6~8 bits。
  3. 同位位元（parity bit）：可選。
  4. 停止位元（stop bit）：1 或多個，值為 1。

- **鮑率（Baud Rate）**：
  - 表示每秒傳輸的 bit 數。
  - 常見值：2400、4800、9600、19200。
  - 範例設計參數：
    - 鮑率：19200
    - 資料位元：8
    - 停止位元：1
    - 不使用同位位元

## UART 接收器 (Receiver)

- 無內嵌時脈，需透過預設參數與過取樣來解碼資料。
- **過取樣（Oversampling）**：
  - 每個位元取樣 16 次，以捕捉中心點。
- **鮑率產生器（Baud Rate Generator）**：
  - 例：19200 鮑率 × 16 = 307200 ticks/sec
  - 若系統時脈為 100MHz → mod-326 計數器

### 資料接收步驟：

1. 偵測起始位元（signal = 0）→ 啟動計數器。
2. 當計數器達 7 → 重設。
3. 當計數器達 15 → 擷取資料位元 → 重設。
4. 重複步驟 3，讀取 8 個資料位元。
5. 再重複一次 → 擷取停止位元。


## 驗證電路設計（Verification Circuit）

- **主要模組**：
  - `mod_m_counter`：產生 s_tick 訊號（鮑率節拍）。
  - `uart_rx`：UART 接收核心，輸出 `rx_data_out` 和 `rx_done_tick`。
  - `db_fsmd_imp`：按鈕防抖處理（BTN_CENTER）。
  - `fifo`：先進先出緩衝區，接收資料。
    - 寫入：由 `rx_done_tick` 觸發。
    - 讀取：由按鈕觸發的 `btn_tick` 控制。

- **實測方式**：
  - 可使用串口調試工具（如：串口調試助手）檢查資料正確性。

